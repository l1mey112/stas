include 'lib/posix/syscalls.stas'
include 'lib/posix/defs.stas'
include 'lib/posix/struc.stas'

const S_RWE_OWNER { S_IRUSR S_IWUSR | S_IXUSR | }

; (size -- ptr bool)
fn memory.mmap_anon? 1 2 {
	NULL swap MAP_PRW MAP_PA UINT64_MAX 0 mmap
	dup MAP_FAILED !=
}

; (size -- ptr)
fn memory.mmap_anon 1 1 {
	memory.mmap_anon? assert -> 'memory.mmap_anon: failed'
}